load('Covid_stress_data_subs.rda')
library(CustomFunctionsYrotha)
setUpGraph()
nicePairsPlot(dat_cvid)
nicePairsPlot(dat_cvid, loess = TRUE)
ls()
hist(dat_cvid$conspiracy, breaks = 10)
nicePairsPlot(dat_cvid, loess = TRUE)
### Copy data:
d <- dat_cvid
### Scale only numeric variables (many different ways to do this):
for(i in 1:ncol(d)){
if(is.numeric(d[,i])){
d[,i] <- scale(d[,i])
}
}
### Bring back unscaled response variable:
d$conspiracy <- dat_cvid$conspiracy
d
head(d)
nicePairsPlot(d)
dim(1:5)
iris[1:4]
a
a <- iris[,1, drop=FALSE]
a
dim(a)
a[1:4]
load('Mnist_training_and_test_data.rda')
dim(train_x.0)
dim(train_y.0)
dim(test_x.0)
dim(test_y.0)
class(test_y.0)
test_y.0
test_y.0[1:2]
?nnet
library(nnet)
?nnet
20*784
1+1
rm(list=ls())
load('Covid_stress_data_subs.rda')
hist(dat_cvid$conspiracy, breaks = 10)
### Copy data:
d <- dat_cvid
### Scale only numeric variables (many different ways to do this):
for(i in 1:ncol(d)){
if(is.numeric(d[,i])){
d[,i] <- scale(d[,i])
}
}
### Bring back unscaled response variable:
d$conspiracy <- dat_cvid$conspiracy
library("nnet")
nn_cvid1 <- nnet(conspiracy ~ ., data=d, size=1, decay=0, linout=TRUE, maxit=10000)
nn_cvid1
t_grid <- expand.grid(size=1:5, decay=0)
t_grid
set.seed(2332)
library("caret")
tune_caret <- train(conspiracy ~ ., data=dat_cvid,
method='nnet', tuneGrid=t_grid, maxit=2, trace=FALSE,
linout=TRUE, preProcess=c("center","scale"))
# trace=FALSE suppresses progress message
tune_caret
x <- array(data = 1:24, dim = c(2,4,3))
x
dim(x)
x[2,3,1]
### Select entire slice:
x[,,2]
load('Mnist_training_and_test_data.rda')
dim(train_x.0)
dim(train_y.0)
dim(test_x.0)
dim(test_y.0)
### Look at labels (only done for test set):
test_y.0[1:20]
train_x.0[1, 28, 2]
pc18 <- train_x.0[,,18]
image(pc18)
### Turn into 2d matrices (each row one picture):
train_x <- array(as.numeric(aperm(train_x.0, perm = c(3, 1, 2))), dim = c(60000, 784))
test_x <- array(as.numeric(aperm(test_x.0, perm = c(3, 1, 2))), dim = c(10000, 784))
### Scale to 0-1 range:
train_x <- train_x/255
test_x <- test_x/255
### Turn number labels to factor:
train_y <- as.factor(train_y.0)
test_y <- as.factor(test_y.0)
### Combine to dataframe:
mnist.dtra <- data.frame("y"=train_y, train_x)
mnist.dte <- data.frame("y"=test_y, test_x)
### Look at dimensions:
dim(mnist.dtra)
dim(mnist.dte)
rm(list=ls())
install.packages("caret")
